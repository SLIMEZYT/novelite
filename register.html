<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register â€” Novelite</title>
<meta name="description" content="Join Novelite today to read, write, and connect with amazing stories. Registration is simple, fast, and free.">
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- LOADER -->
<div class="loader" id="loader">
  <div class="ink-ring"></div>
  <div class="quill"></div>
</div>

<section class="registration">
  <h1>Join Novelite</h1>
  <p>Start reading and sharing stories today.</p>
  
  <form id="registerForm">
    <input type="text" id="name" placeholder="Full Name" required>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <select id="ageGroup" multiple>
      <option value="child">Child</option>
      <option value="teen">Teen</option>
      <option value="adult">Adult</option>
    </select>
    <select id="genres" multiple>
      <option value="fiction">Fiction</option>
      <option value="non-fiction">Non-Fiction</option>
      <option value="romance">Romance</option>
      <option value="fantasy">Fantasy</option>
      <option value="poetry">Poetry</option>
    </select>
    <button type="submit">Register</button>
  </form>
</section>

<script type="module">
import { neon } from '@netlify/neon';

const sql = neon();

window.addEventListener('load', () => {
  document.getElementById('loader').style.display = 'none';
});

document.getElementById('registerForm').addEventListener('submit', async e => {
  e.preventDefault();
  
  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const ageGroup = Array.from(document.getElementById('ageGroup').selectedOptions).map(o=>o.value);
  const genres = Array.from(document.getElementById('genres').selectedOptions).map(o=>o.value);
  
  try {
    await sql`INSERT INTO users (name, email, password, age_group, genres) VALUES (${name}, ${email}, ${password}, ${ageGroup}, ${genres})`;
    alert('Registration successful!');
    window.location.href = 'books.html';
  } catch (err) {
    alert('Error: ' + err.message);
  }
});
</script>
</body>
</html>
